\hypertarget{smart__card__higher__level__functions_8c}{}\section{src/\+C\+A\+R\+D/smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.c File Reference}
\label{smart__card__higher__level__functions_8c}\index{src/\+C\+A\+R\+D/smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{src/\+C\+A\+R\+D/smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}


Smart Card high level functions Copyright \mbox{[}2014\mbox{]} \mbox{[}Mathieu Stephan\mbox{]}.  


{\ttfamily \#include \char`\"{}smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}oled\+\_\+wrapper.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}smartcard.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}defines.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}usb.\+h\char`\"{}}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{smart__card__higher__level__functions_8c_a8e84c58988f1c74b449d1cb03cf5e3bb}{read\+A\+E\+S256\+Bits\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the A\+ES 256 bits key from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a1a6c723aac7719d09b2e5d838bc62868}{read\+Application\+Zone1} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read Application Zone 1 data. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a11d1c04dd6d0cb14511a3de79611205c}{write\+Application\+Zone1} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write Application Zone 1 data. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a149d9e4a93233be221e7f7a341aa53e9}{read\+Application\+Zone2} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read Application Zone 2 data. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a8bb62eba728d4c82a6950de4dade9f88}{write\+Application\+Zone2} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write Application Zone 2 data. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a43f7372f8d90584206585b306793b2a6}{read\+Mooltipass\+Website\+Login} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the Mooltipass website login from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_af36c0c232ef7d48051edc20e4aa51b3a}{read\+Mooltipass\+Website\+Password} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the Mooltipass website password from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_a5fd5bbec32131b872c2a612b883bc00b}{read\+Fabrication\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the fabrication zone (security mode 1\&2) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_ae1d9e97e1a8b2718d50a660a9b291bc2}{read\+Issuer\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the issuer zone (security mode 1\&2) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_aaed89b61a459e1aff83e5d25781a71cc}{write\+Issuer\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write in the issuer zone (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_adb9108073c8b4b115d5954445f9762af}{read\+Security\+Code\+Attempts\+Counters} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the number of code attempts left (security mode 1\&2) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_af1c29b879c62774da8d7c660caccab40}{read\+Code\+Protected\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the code protected zone (security mode 1\&2 -\/ Authenticated!) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a8e52507fa438bbb794fc6e1d36398647}{write\+Code\+Protected\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write in the code protected zone (security mode 1\&2 -\/ Authenticated!) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_aa114d024b1c4bde9dcab77878b030e85}{read\+Application\+Zone1\+Erase\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the application zone1 erase key (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a6880d385434c157a7c33940e483ee0f3}{write\+Application\+Zone1\+Erase\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write the application zone1 erase key (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_afc3a1356ebd232417392dfb0a8bb32e2}{read\+Application\+Zone2\+Erase\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the application zone2 erase key (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a2d437e1c612be5050c8ef3b622440c3f}{write\+Application\+Zone2\+Erase\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write the application zone2 erase key (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_a6693624f859532ae77452a81092a3aa3}{read\+Memory\+Test\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the Test zone (security mode 1\&2) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_aaea6e5b5a5624c12f0d79523f7040d79}{write\+Memory\+Test\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write in the Test zone (security mode 1\&2) \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{smart__card__higher__level__functions_8c_accbf3fb1d94ade85ce80a59c66aa6a0b}{read\+Manufacturer\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Read the manufacturer zone (security mode 1\&2) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_ac3e956423efc401426590dd15dfad2c5}{write\+Manufacturer\+Zone} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write in the manufacturer zone (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a8e2dbac02af2437018e0e9a636fe1a96}{write\+Manufacturer\+Fuse} (void)\hypertarget{smart__card__higher__level__functions_8c_a8e2dbac02af2437018e0e9a636fe1a96}{}\label{smart__card__higher__level__functions_8c_a8e2dbac02af2437018e0e9a636fe1a96}

\begin{DoxyCompactList}\small\item\em Write manufacturer fuse, controlling access to the M\+FZ. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a4c8d6cddbd4c647f0d4aaf4bfb7094e1}{write\+\_\+issuers\+\_\+fuse} (void)\hypertarget{smart__card__higher__level__functions_8c_a4c8d6cddbd4c647f0d4aaf4bfb7094e1}{}\label{smart__card__higher__level__functions_8c_a4c8d6cddbd4c647f0d4aaf4bfb7094e1}

\begin{DoxyCompactList}\small\item\em Write issuers fuse, setting the A\+T88\+S\+C102 into Security Mode 2, we need to be authenticated here. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_aebd3ea1d502ac0d2f54c3ceffabb2191}{write\+\_\+ec2en\+\_\+fuse} (void)\hypertarget{smart__card__higher__level__functions_8c_aebd3ea1d502ac0d2f54c3ceffabb2191}{}\label{smart__card__higher__level__functions_8c_aebd3ea1d502ac0d2f54c3ceffabb2191}

\begin{DoxyCompactList}\small\item\em Write ec2en fuse, to be done before blowing issuer fuse. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a85fb3290373002b320ade5d3f7e89364}{check\+Security\+Mode2} (void)
\begin{DoxyCompactList}\small\item\em Check that the smartcard is in mode two by trying to write his manufacturer zone. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a86112ccfde7d83e397f772156e7fd2eb}{mooltipass\+Detected\+Routine} (volatile uint16\+\_\+t $\ast$pin\+\_\+code)
\begin{DoxyCompactList}\small\item\em Function called when a Mooltipass is inserted into the smart card slot. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a1dfd537b32de57cdf69ead8584729643}{card\+Detected\+Routine} (void)
\begin{DoxyCompactList}\small\item\em Function called when something is inserted into the smart card slot. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a08acefad14505738a8b5aafb9f97312f}{transform\+Blank\+Card\+Into\+Mooltipass} (void)
\begin{DoxyCompactList}\small\item\em Transform the card into a Mooltipass card (Security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_aa3b858a4a6f8da770f93c28f8329e26c}{erase\+Smart\+Card} (void)\hypertarget{smart__card__higher__level__functions_8c_aa3b858a4a6f8da770f93c28f8329e26c}{}\label{smart__card__higher__level__functions_8c_aa3b858a4a6f8da770f93c28f8329e26c}

\begin{DoxyCompactList}\small\item\em Completely erase mooltipass card (Security mode 2 -\/ Authenticated!) \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a7fecbaa3e22b83c1f00bb3e747d30bfd}{write\+To\+Application\+Zone\+And\+Check} (uint16\+\_\+t addr, uint16\+\_\+t nb\+\_\+bits, uint8\+\_\+t $\ast$buffer, uint8\+\_\+t $\ast$temp\+\_\+buffer)
\begin{DoxyCompactList}\small\item\em Write to one application zone and check what we wrote. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a60598fe1b6fa995620a548fac7df1abc}{write\+A\+E\+S256\+Bits\+Key} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write the A\+ES 256 bits key to the card. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_ab4480ba7ae707a8bb275397af2ec6315}{write\+Mooltipass\+Website\+Password} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write the Mooltipass website password to the card. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_aa1a2243441d0ba0a0ac487f5e5b9b85c}{write\+Mooltipass\+Website\+Login} (uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Write the Mooltipass website login to the card. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_aa765848846e8970caa0dc4b147643a7a}{reset\+Blank\+Card} (void)\hypertarget{smart__card__higher__level__functions_8c_aa765848846e8970caa0dc4b147643a7a}{}\label{smart__card__higher__level__functions_8c_aa765848846e8970caa0dc4b147643a7a}

\begin{DoxyCompactList}\small\item\em Reinitialize the card to its default settings \& default pin (Security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{smart__card__higher__level__functions_8c_a11c468b258a4fcb46d4d2134aa33c1a5}{read\+Security\+Code} (void)
\begin{DoxyCompactList}\small\item\em Read the security code (security mode 1 -\/ Authenticated!) \end{DoxyCompactList}\item 
void {\bfseries write\+Security\+Code} (volatile uint16\+\_\+t $\ast$code)\hypertarget{smart__card__higher__level__functions_8c_a25eadf86215687e10e8cac0e40b3c288}{}\label{smart__card__higher__level__functions_8c_a25eadf86215687e10e8cac0e40b3c288}

\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a5db7aa4e74b13c2c5885ebaeb4d5ee44}{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1} (void)
\begin{DoxyCompactList}\small\item\em Function called to only allow reads and writes to the application zone 1 when authenticated. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a61ff766e63a501c5648404fee170311a}{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1} (void)
\begin{DoxyCompactList}\small\item\em Function called to check that only reads and writes are allowed to the application zone 1 when authenticated. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_ac24f5049a7dc3678cf4e626997abd423}{set\+Authenticated\+Read\+Write\+Access\+To\+Zone2} (void)
\begin{DoxyCompactList}\small\item\em Function called to only allow reads and writes to the application zone 2 when authenticated. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a27acff09bde7437161126876e6bd0b3f}{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1and2} (void)\hypertarget{smart__card__higher__level__functions_8c_a27acff09bde7437161126876e6bd0b3f}{}\label{smart__card__higher__level__functions_8c_a27acff09bde7437161126876e6bd0b3f}

\begin{DoxyCompactList}\small\item\em Function called to only allow reads and writes to the application zone 1 \& 2 when authenticated. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_add2d4d1ebe049640ff9c45b9496c9dad}{check\+Authenticated\+Read\+Write\+Access\+To\+Zone2} (void)
\begin{DoxyCompactList}\small\item\em Function called to check that only reads and writes are allowed to the application zone 2 when authenticated. \end{DoxyCompactList}\item 
R\+E\+T\+\_\+\+T\+Y\+PE \hyperlink{smart__card__higher__level__functions_8c_a28531607245935c9dcb57b9651700aa2}{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2} (void)
\begin{DoxyCompactList}\small\item\em Function called to check that only reads and writes are allowed to the application zone 1 when authenticated. \end{DoxyCompactList}\item 
void \hyperlink{smart__card__higher__level__functions_8c_a30276e69e53b9b841013486daeb8cb18}{print\+S\+M\+C\+Debug\+Info\+To\+U\+SB} (void)\hypertarget{smart__card__higher__level__functions_8c_a30276e69e53b9b841013486daeb8cb18}{}\label{smart__card__higher__level__functions_8c_a30276e69e53b9b841013486daeb8cb18}

\begin{DoxyCompactList}\small\item\em Print the card info. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{smart__card__higher__level__functions_8c_ae494310cfa8dc0185aee9d4d0ccf0ded}{get\+Number\+Of\+Security\+Code\+Tries\+Left} (void)
\begin{DoxyCompactList}\small\item\em Get the number of security code tries left. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{smart__card__higher__level__functions_8c_a1633ae4568416bd831428a3497b5b5e7}{get\+Number\+Of\+A\+Z2\+Writes\+Left} (void)
\begin{DoxyCompactList}\small\item\em Get the number of A\+Z2 writes left in case E\+C2 is not blown. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Smart Card high level functions Copyright \mbox{[}2014\mbox{]} \mbox{[}Mathieu Stephan\mbox{]}. 



\subsection{Function Documentation}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!card\+Detected\+Routine@{card\+Detected\+Routine}}
\index{card\+Detected\+Routine@{card\+Detected\+Routine}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{card\+Detected\+Routine(void)}{cardDetectedRoutine(void)}}]{\setlength{\rightskip}{0pt plus 5cm}card\+Detected\+Routine (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a1dfd537b32de57cdf69ead8584729643}{}\label{smart__card__higher__level__functions_8c_a1dfd537b32de57cdf69ead8584729643}


Function called when something is inserted into the smart card slot. 

\begin{DoxyReturn}{Returns}
What the card is / what needs to be done (see mooltipass\+\_\+detect\+\_\+return\+\_\+t) 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!check\+Authenticated\+Read\+Write\+Access\+To\+Zone1@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1}}
\index{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1(void)}{checkAuthenticatedReadWriteAccessToZone1(void)}}]{\setlength{\rightskip}{0pt plus 5cm}check\+Authenticated\+Read\+Write\+Access\+To\+Zone1 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a61ff766e63a501c5648404fee170311a}{}\label{smart__card__higher__level__functions_8c_a61ff766e63a501c5648404fee170311a}


Function called to check that only reads and writes are allowed to the application zone 1 when authenticated. 

\begin{DoxyReturn}{Returns}
OK or N\+OK 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2}}
\index{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2(void)}{checkAuthenticatedReadWriteAccessToZone1And2(void)}}]{\setlength{\rightskip}{0pt plus 5cm}check\+Authenticated\+Read\+Write\+Access\+To\+Zone1\+And2 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a28531607245935c9dcb57b9651700aa2}{}\label{smart__card__higher__level__functions_8c_a28531607245935c9dcb57b9651700aa2}


Function called to check that only reads and writes are allowed to the application zone 1 when authenticated. 

\begin{DoxyReturn}{Returns}
OK or N\+OK 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!check\+Authenticated\+Read\+Write\+Access\+To\+Zone2@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone2}}
\index{check\+Authenticated\+Read\+Write\+Access\+To\+Zone2@{check\+Authenticated\+Read\+Write\+Access\+To\+Zone2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{check\+Authenticated\+Read\+Write\+Access\+To\+Zone2(void)}{checkAuthenticatedReadWriteAccessToZone2(void)}}]{\setlength{\rightskip}{0pt plus 5cm}check\+Authenticated\+Read\+Write\+Access\+To\+Zone2 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_add2d4d1ebe049640ff9c45b9496c9dad}{}\label{smart__card__higher__level__functions_8c_add2d4d1ebe049640ff9c45b9496c9dad}


Function called to check that only reads and writes are allowed to the application zone 2 when authenticated. 

\begin{DoxyReturn}{Returns}
OK or N\+OK 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!check\+Security\+Mode2@{check\+Security\+Mode2}}
\index{check\+Security\+Mode2@{check\+Security\+Mode2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{check\+Security\+Mode2(void)}{checkSecurityMode2(void)}}]{\setlength{\rightskip}{0pt plus 5cm}check\+Security\+Mode2 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a85fb3290373002b320ade5d3f7e89364}{}\label{smart__card__higher__level__functions_8c_a85fb3290373002b320ade5d3f7e89364}


Check that the smartcard is in mode two by trying to write his manufacturer zone. 

\begin{DoxyReturn}{Returns}
Success status 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!get\+Number\+Of\+A\+Z2\+Writes\+Left@{get\+Number\+Of\+A\+Z2\+Writes\+Left}}
\index{get\+Number\+Of\+A\+Z2\+Writes\+Left@{get\+Number\+Of\+A\+Z2\+Writes\+Left}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{get\+Number\+Of\+A\+Z2\+Writes\+Left(void)}{getNumberOfAZ2WritesLeft(void)}}]{\setlength{\rightskip}{0pt plus 5cm}get\+Number\+Of\+A\+Z2\+Writes\+Left (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a1633ae4568416bd831428a3497b5b5e7}{}\label{smart__card__higher__level__functions_8c_a1633ae4568416bd831428a3497b5b5e7}


Get the number of A\+Z2 writes left in case E\+C2 is not blown. 

\begin{DoxyReturn}{Returns}
Number of tries left 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!get\+Number\+Of\+Security\+Code\+Tries\+Left@{get\+Number\+Of\+Security\+Code\+Tries\+Left}}
\index{get\+Number\+Of\+Security\+Code\+Tries\+Left@{get\+Number\+Of\+Security\+Code\+Tries\+Left}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{get\+Number\+Of\+Security\+Code\+Tries\+Left(void)}{getNumberOfSecurityCodeTriesLeft(void)}}]{\setlength{\rightskip}{0pt plus 5cm}get\+Number\+Of\+Security\+Code\+Tries\+Left (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_ae494310cfa8dc0185aee9d4d0ccf0ded}{}\label{smart__card__higher__level__functions_8c_ae494310cfa8dc0185aee9d4d0ccf0ded}


Get the number of security code tries left. 

\begin{DoxyReturn}{Returns}
Number of tries left 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!mooltipass\+Detected\+Routine@{mooltipass\+Detected\+Routine}}
\index{mooltipass\+Detected\+Routine@{mooltipass\+Detected\+Routine}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{mooltipass\+Detected\+Routine(volatile uint16\+\_\+t $\ast$pin\+\_\+code)}{mooltipassDetectedRoutine(volatile uint16_t *pin_code)}}]{\setlength{\rightskip}{0pt plus 5cm}mooltipass\+Detected\+Routine (
\begin{DoxyParamCaption}
\item[{volatile uint16\+\_\+t $\ast$}]{pin\+\_\+code}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a86112ccfde7d83e397f772156e7fd2eb}{}\label{smart__card__higher__level__functions_8c_a86112ccfde7d83e397f772156e7fd2eb}


Function called when a Mooltipass is inserted into the smart card slot. 


\begin{DoxyParams}{Parameters}
{\em pin\+\_\+code} & Mooltipass pin code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If we managed to unlock it / if there is other problem (see mooltipass\+\_\+detect\+\_\+return\+\_\+t) 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+A\+E\+S256\+Bits\+Key@{read\+A\+E\+S256\+Bits\+Key}}
\index{read\+A\+E\+S256\+Bits\+Key@{read\+A\+E\+S256\+Bits\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+A\+E\+S256\+Bits\+Key(uint8\+\_\+t $\ast$buffer)}{readAES256BitsKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+A\+E\+S256\+Bits\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a8e84c58988f1c74b449d1cb03cf5e3bb}{}\label{smart__card__higher__level__functions_8c_a8e84c58988f1c74b449d1cb03cf5e3bb}


Read the A\+ES 256 bits key from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer to store the A\+ES key \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Application\+Zone1@{read\+Application\+Zone1}}
\index{read\+Application\+Zone1@{read\+Application\+Zone1}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Application\+Zone1(uint8\+\_\+t $\ast$buffer)}{readApplicationZone1(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Application\+Zone1 (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a1a6c723aac7719d09b2e5d838bc62868}{}\label{smart__card__higher__level__functions_8c_a1a6c723aac7719d09b2e5d838bc62868}


Read Application Zone 1 data. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer to store the data \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Application\+Zone1\+Erase\+Key@{read\+Application\+Zone1\+Erase\+Key}}
\index{read\+Application\+Zone1\+Erase\+Key@{read\+Application\+Zone1\+Erase\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Application\+Zone1\+Erase\+Key(uint8\+\_\+t $\ast$buffer)}{readApplicationZone1EraseKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Application\+Zone1\+Erase\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_aa114d024b1c4bde9dcab77878b030e85}{}\label{smart__card__higher__level__functions_8c_aa114d024b1c4bde9dcab77878b030e85}


Read the application zone1 erase key (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (6 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Application\+Zone2@{read\+Application\+Zone2}}
\index{read\+Application\+Zone2@{read\+Application\+Zone2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Application\+Zone2(uint8\+\_\+t $\ast$buffer)}{readApplicationZone2(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Application\+Zone2 (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a149d9e4a93233be221e7f7a341aa53e9}{}\label{smart__card__higher__level__functions_8c_a149d9e4a93233be221e7f7a341aa53e9}


Read Application Zone 2 data. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer to store the data \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Application\+Zone2\+Erase\+Key@{read\+Application\+Zone2\+Erase\+Key}}
\index{read\+Application\+Zone2\+Erase\+Key@{read\+Application\+Zone2\+Erase\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Application\+Zone2\+Erase\+Key(uint8\+\_\+t $\ast$buffer)}{readApplicationZone2EraseKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Application\+Zone2\+Erase\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_afc3a1356ebd232417392dfb0a8bb32e2}{}\label{smart__card__higher__level__functions_8c_afc3a1356ebd232417392dfb0a8bb32e2}


Read the application zone2 erase key (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (4 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Code\+Protected\+Zone@{read\+Code\+Protected\+Zone}}
\index{read\+Code\+Protected\+Zone@{read\+Code\+Protected\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Code\+Protected\+Zone(uint8\+\_\+t $\ast$buffer)}{readCodeProtectedZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Code\+Protected\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_af1c29b879c62774da8d7c660caccab40}{}\label{smart__card__higher__level__functions_8c_af1c29b879c62774da8d7c660caccab40}


Read the code protected zone (security mode 1\&2 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (8 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Fabrication\+Zone@{read\+Fabrication\+Zone}}
\index{read\+Fabrication\+Zone@{read\+Fabrication\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Fabrication\+Zone(uint8\+\_\+t $\ast$buffer)}{readFabricationZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Fabrication\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a5fd5bbec32131b872c2a612b883bc00b}{}\label{smart__card__higher__level__functions_8c_a5fd5bbec32131b872c2a612b883bc00b}


Read the fabrication zone (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Issuer\+Zone@{read\+Issuer\+Zone}}
\index{read\+Issuer\+Zone@{read\+Issuer\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Issuer\+Zone(uint8\+\_\+t $\ast$buffer)}{readIssuerZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Issuer\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_ae1d9e97e1a8b2718d50a660a9b291bc2}{}\label{smart__card__higher__level__functions_8c_ae1d9e97e1a8b2718d50a660a9b291bc2}


Read the issuer zone (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (8 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Manufacturer\+Zone@{read\+Manufacturer\+Zone}}
\index{read\+Manufacturer\+Zone@{read\+Manufacturer\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Manufacturer\+Zone(uint8\+\_\+t $\ast$buffer)}{readManufacturerZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Manufacturer\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_accbf3fb1d94ade85ce80a59c66aa6a0b}{}\label{smart__card__higher__level__functions_8c_accbf3fb1d94ade85ce80a59c66aa6a0b}


Read the manufacturer zone (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Memory\+Test\+Zone@{read\+Memory\+Test\+Zone}}
\index{read\+Memory\+Test\+Zone@{read\+Memory\+Test\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Memory\+Test\+Zone(uint8\+\_\+t $\ast$buffer)}{readMemoryTestZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Memory\+Test\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a6693624f859532ae77452a81092a3aa3}{}\label{smart__card__higher__level__functions_8c_a6693624f859532ae77452a81092a3aa3}


Read the Test zone (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Mooltipass\+Website\+Login@{read\+Mooltipass\+Website\+Login}}
\index{read\+Mooltipass\+Website\+Login@{read\+Mooltipass\+Website\+Login}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Mooltipass\+Website\+Login(uint8\+\_\+t $\ast$buffer)}{readMooltipassWebsiteLogin(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Mooltipass\+Website\+Login (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a43f7372f8d90584206585b306793b2a6}{}\label{smart__card__higher__level__functions_8c_a43f7372f8d90584206585b306793b2a6}


Read the Mooltipass website login from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer to store the login \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Mooltipass\+Website\+Password@{read\+Mooltipass\+Website\+Password}}
\index{read\+Mooltipass\+Website\+Password@{read\+Mooltipass\+Website\+Password}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Mooltipass\+Website\+Password(uint8\+\_\+t $\ast$buffer)}{readMooltipassWebsitePassword(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Mooltipass\+Website\+Password (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_af36c0c232ef7d48051edc20e4aa51b3a}{}\label{smart__card__higher__level__functions_8c_af36c0c232ef7d48051edc20e4aa51b3a}


Read the Mooltipass website password from the card. Note that it is up to the code calling this function to check that we\textquotesingle{}re authenticated, otherwise 0s will be read. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer to store the password \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Security\+Code@{read\+Security\+Code}}
\index{read\+Security\+Code@{read\+Security\+Code}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Security\+Code(void)}{readSecurityCode(void)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Security\+Code (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a11c468b258a4fcb46d4d2134aa33c1a5}{}\label{smart__card__higher__level__functions_8c_a11c468b258a4fcb46d4d2134aa33c1a5}


Read the security code (security mode 1 -\/ Authenticated!) 

\begin{DoxyReturn}{Returns}
The security code 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!read\+Security\+Code\+Attempts\+Counters@{read\+Security\+Code\+Attempts\+Counters}}
\index{read\+Security\+Code\+Attempts\+Counters@{read\+Security\+Code\+Attempts\+Counters}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{read\+Security\+Code\+Attempts\+Counters(uint8\+\_\+t $\ast$buffer)}{readSecurityCodeAttemptsCounters(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}read\+Security\+Code\+Attempts\+Counters (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_adb9108073c8b4b115d5954445f9762af}{}\label{smart__card__higher__level__functions_8c_adb9108073c8b4b115d5954445f9762af}


Read the number of code attempts left (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The provided pointer 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!set\+Authenticated\+Read\+Write\+Access\+To\+Zone1@{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1}}
\index{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1@{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{set\+Authenticated\+Read\+Write\+Access\+To\+Zone1(void)}{setAuthenticatedReadWriteAccessToZone1(void)}}]{\setlength{\rightskip}{0pt plus 5cm}set\+Authenticated\+Read\+Write\+Access\+To\+Zone1 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a5db7aa4e74b13c2c5885ebaeb4d5ee44}{}\label{smart__card__higher__level__functions_8c_a5db7aa4e74b13c2c5885ebaeb4d5ee44}


Function called to only allow reads and writes to the application zone 1 when authenticated. 

\begin{DoxyReturn}{Returns}
Operation success 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!set\+Authenticated\+Read\+Write\+Access\+To\+Zone2@{set\+Authenticated\+Read\+Write\+Access\+To\+Zone2}}
\index{set\+Authenticated\+Read\+Write\+Access\+To\+Zone2@{set\+Authenticated\+Read\+Write\+Access\+To\+Zone2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{set\+Authenticated\+Read\+Write\+Access\+To\+Zone2(void)}{setAuthenticatedReadWriteAccessToZone2(void)}}]{\setlength{\rightskip}{0pt plus 5cm}set\+Authenticated\+Read\+Write\+Access\+To\+Zone2 (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_ac24f5049a7dc3678cf4e626997abd423}{}\label{smart__card__higher__level__functions_8c_ac24f5049a7dc3678cf4e626997abd423}


Function called to only allow reads and writes to the application zone 2 when authenticated. 

\begin{DoxyReturn}{Returns}
Operation success 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!transform\+Blank\+Card\+Into\+Mooltipass@{transform\+Blank\+Card\+Into\+Mooltipass}}
\index{transform\+Blank\+Card\+Into\+Mooltipass@{transform\+Blank\+Card\+Into\+Mooltipass}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{transform\+Blank\+Card\+Into\+Mooltipass(void)}{transformBlankCardIntoMooltipass(void)}}]{\setlength{\rightskip}{0pt plus 5cm}transform\+Blank\+Card\+Into\+Mooltipass (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a08acefad14505738a8b5aafb9f97312f}{}\label{smart__card__higher__level__functions_8c_a08acefad14505738a8b5aafb9f97312f}


Transform the card into a Mooltipass card (Security mode 1 -\/ Authenticated!) 

\begin{DoxyReturn}{Returns}
If we succeeded 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+A\+E\+S256\+Bits\+Key@{write\+A\+E\+S256\+Bits\+Key}}
\index{write\+A\+E\+S256\+Bits\+Key@{write\+A\+E\+S256\+Bits\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+A\+E\+S256\+Bits\+Key(uint8\+\_\+t $\ast$buffer)}{writeAES256BitsKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+A\+E\+S256\+Bits\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a60598fe1b6fa995620a548fac7df1abc}{}\label{smart__card__higher__level__functions_8c_a60598fe1b6fa995620a548fac7df1abc}


Write the A\+ES 256 bits key to the card. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer containing the A\+ES key \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Operation success 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Application\+Zone1@{write\+Application\+Zone1}}
\index{write\+Application\+Zone1@{write\+Application\+Zone1}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Application\+Zone1(uint8\+\_\+t $\ast$buffer)}{writeApplicationZone1(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Application\+Zone1 (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a11d1c04dd6d0cb14511a3de79611205c}{}\label{smart__card__higher__level__functions_8c_a11d1c04dd6d0cb14511a3de79611205c}


Write Application Zone 1 data. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Data to be written \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Application\+Zone1\+Erase\+Key@{write\+Application\+Zone1\+Erase\+Key}}
\index{write\+Application\+Zone1\+Erase\+Key@{write\+Application\+Zone1\+Erase\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Application\+Zone1\+Erase\+Key(uint8\+\_\+t $\ast$buffer)}{writeApplicationZone1EraseKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Application\+Zone1\+Erase\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a6880d385434c157a7c33940e483ee0f3}{}\label{smart__card__higher__level__functions_8c_a6880d385434c157a7c33940e483ee0f3}


Write the application zone1 erase key (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (6 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Application\+Zone2@{write\+Application\+Zone2}}
\index{write\+Application\+Zone2@{write\+Application\+Zone2}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Application\+Zone2(uint8\+\_\+t $\ast$buffer)}{writeApplicationZone2(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Application\+Zone2 (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a8bb62eba728d4c82a6950de4dade9f88}{}\label{smart__card__higher__level__functions_8c_a8bb62eba728d4c82a6950de4dade9f88}


Write Application Zone 2 data. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Data to be written \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Application\+Zone2\+Erase\+Key@{write\+Application\+Zone2\+Erase\+Key}}
\index{write\+Application\+Zone2\+Erase\+Key@{write\+Application\+Zone2\+Erase\+Key}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Application\+Zone2\+Erase\+Key(uint8\+\_\+t $\ast$buffer)}{writeApplicationZone2EraseKey(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Application\+Zone2\+Erase\+Key (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a2d437e1c612be5050c8ef3b622440c3f}{}\label{smart__card__higher__level__functions_8c_a2d437e1c612be5050c8ef3b622440c3f}


Write the application zone2 erase key (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (4 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Code\+Protected\+Zone@{write\+Code\+Protected\+Zone}}
\index{write\+Code\+Protected\+Zone@{write\+Code\+Protected\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Code\+Protected\+Zone(uint8\+\_\+t $\ast$buffer)}{writeCodeProtectedZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Code\+Protected\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a8e52507fa438bbb794fc6e1d36398647}{}\label{smart__card__higher__level__functions_8c_a8e52507fa438bbb794fc6e1d36398647}


Write in the code protected zone (security mode 1\&2 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (8 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Issuer\+Zone@{write\+Issuer\+Zone}}
\index{write\+Issuer\+Zone@{write\+Issuer\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Issuer\+Zone(uint8\+\_\+t $\ast$buffer)}{writeIssuerZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Issuer\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_aaed89b61a459e1aff83e5d25781a71cc}{}\label{smart__card__higher__level__functions_8c_aaed89b61a459e1aff83e5d25781a71cc}


Write in the issuer zone (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (8 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Manufacturer\+Zone@{write\+Manufacturer\+Zone}}
\index{write\+Manufacturer\+Zone@{write\+Manufacturer\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Manufacturer\+Zone(uint8\+\_\+t $\ast$buffer)}{writeManufacturerZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Manufacturer\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_ac3e956423efc401426590dd15dfad2c5}{}\label{smart__card__higher__level__functions_8c_ac3e956423efc401426590dd15dfad2c5}


Write in the manufacturer zone (security mode 1 -\/ Authenticated!) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Memory\+Test\+Zone@{write\+Memory\+Test\+Zone}}
\index{write\+Memory\+Test\+Zone@{write\+Memory\+Test\+Zone}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Memory\+Test\+Zone(uint8\+\_\+t $\ast$buffer)}{writeMemoryTestZone(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Memory\+Test\+Zone (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_aaea6e5b5a5624c12f0d79523f7040d79}{}\label{smart__card__higher__level__functions_8c_aaea6e5b5a5624c12f0d79523f7040d79}


Write in the Test zone (security mode 1\&2) 


\begin{DoxyParams}{Parameters}
{\em buffer} & Pointer to a buffer (2 bytes required) \\
\hline
\end{DoxyParams}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Mooltipass\+Website\+Login@{write\+Mooltipass\+Website\+Login}}
\index{write\+Mooltipass\+Website\+Login@{write\+Mooltipass\+Website\+Login}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Mooltipass\+Website\+Login(uint8\+\_\+t $\ast$buffer)}{writeMooltipassWebsiteLogin(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Mooltipass\+Website\+Login (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_aa1a2243441d0ba0a0ac487f5e5b9b85c}{}\label{smart__card__higher__level__functions_8c_aa1a2243441d0ba0a0ac487f5e5b9b85c}


Write the Mooltipass website login to the card. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer containing the login \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Operation success 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+Mooltipass\+Website\+Password@{write\+Mooltipass\+Website\+Password}}
\index{write\+Mooltipass\+Website\+Password@{write\+Mooltipass\+Website\+Password}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+Mooltipass\+Website\+Password(uint8\+\_\+t $\ast$buffer)}{writeMooltipassWebsitePassword(uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+Mooltipass\+Website\+Password (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_ab4480ba7ae707a8bb275397af2ec6315}{}\label{smart__card__higher__level__functions_8c_ab4480ba7ae707a8bb275397af2ec6315}


Write the Mooltipass website password to the card. 


\begin{DoxyParams}{Parameters}
{\em buffer} & Buffer containing the password \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Operation success 
\end{DoxyReturn}
\index{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}!write\+To\+Application\+Zone\+And\+Check@{write\+To\+Application\+Zone\+And\+Check}}
\index{write\+To\+Application\+Zone\+And\+Check@{write\+To\+Application\+Zone\+And\+Check}!smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c@{smart\+\_\+card\+\_\+higher\+\_\+level\+\_\+functions.\+c}}
\subsubsection[{\texorpdfstring{write\+To\+Application\+Zone\+And\+Check(uint16\+\_\+t addr, uint16\+\_\+t nb\+\_\+bits, uint8\+\_\+t $\ast$buffer, uint8\+\_\+t $\ast$temp\+\_\+buffer)}{writeToApplicationZoneAndCheck(uint16_t addr, uint16_t nb_bits, uint8_t *buffer, uint8_t *temp_buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}write\+To\+Application\+Zone\+And\+Check (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{addr, }
\item[{uint16\+\_\+t}]{nb\+\_\+bits, }
\item[{uint8\+\_\+t $\ast$}]{buffer, }
\item[{uint8\+\_\+t $\ast$}]{temp\+\_\+buffer}
\end{DoxyParamCaption}
)}\hypertarget{smart__card__higher__level__functions_8c_a7fecbaa3e22b83c1f00bb3e747d30bfd}{}\label{smart__card__higher__level__functions_8c_a7fecbaa3e22b83c1f00bb3e747d30bfd}


Write to one application zone and check what we wrote. 


\begin{DoxyParams}{Parameters}
{\em addr} & Address in bits of the place to write \\
\hline
{\em nb\+\_\+bits} & Number of bits to write \\
\hline
{\em buffer} & Buffer containing the data to write \\
\hline
{\em temp\+\_\+buffer} & A temporary buffer having the same size as buffer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If we succeeded 
\end{DoxyReturn}
